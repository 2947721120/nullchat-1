<template name="message">
    <div id="{{_id}}" class="row message {{myMessage}} {{hasMention}} animated fadeIn"
         style="{{color}}">
        {{#if isPlain}}
            {{>messageUser authorId}}:
            {{#if isUnderEdit}}
                <input type="text" name="newMessageText" class="messageEditInput" value="{{message}}"/>
                <button class="messageEditSubmit">save</button>
                <button class="canceleEditSubmit">cancel</button>
            {{else}}
                <span class="clickableMessageBody">
                    {{{finalMessageBody}}}
                </span>
                {{#if canEdit}}
                    <button class="editMessageButton">edit</button>
                {{/if}}
            {{/if}}
            {{#if hasEdits}}
                <span class="lastEditTime">Edited {{lastEditTime}}</span>
            {{/if}}
            <a class="messagePermaLink" href="/message/{{_id}}">link</a>
            <a class="likeMessageLink" href="#"><i class="fa {{starIcon}}"></i><span class="likedBy">{{likedBy.length}}</span></a>
        {{else}}{{#if isRich}}
            {{>messageUser authorId}}:
            {{> UI.dynamic template=layoutName data=data}}
        {{else}}{{#if isFeedback}}
            <span class="feedback-message">{{{message}}}</span>
        {{/if}}{{/if}}{{/if}}
        {{showTimestamp}}
    </div>
</template>