<template name="message">
    <div id="{{_id}}" class="row message {{myMessage}} {{hasMention}} animated fadeIn"
         style="{{color}}">
        {{#if isPlain}}
            {{>messageUser authorId}}:
        <div class="message-content">
            {{#if isUnderEdit}}
                <input type="text" name="newMessageText" class="messageEditInput" value="{{message}}"/>
                <button class="messageEditSubmit">save</button>
                <button class="canceleEditSubmit">cancel</button>
            {{else}}
                <span class="clickableMessageBody">
                    {{{finalMessageBody}}}
                </span>
                <a class="likeMessageLink" href="#"><i class="fa {{starIcon}} hvr-icon-fade"></i><span class="likedBy">{{likedBy.length}}</span></a>
            {{/if}}
            {{#if hasEdits}}
                <span class="lastEditTime">Edited {{lastEditTime}}</span>
            {{/if}}
            <span class="message-extras">
                {{#if canEdit}}
                    <a href="#" class="editMessageButton">edit</a>
                {{/if}}
                <a class="messagePermaLink" href="/message/{{_id}}">permalink</a>
            </span>
        </div>
        {{else}}{{#if isRich}}
            {{>messageUser authorId}}:
        <div class="message-content">
            {{> UI.dynamic template=layoutName data=data}}
        </div>
        {{else}}{{#if isFeedback}}
            <span class="feedback-message">{{{message}}}</span>
        {{/if}}{{/if}}{{/if}}
        <div class="message-timestamp">{{showTimestamp}}</div>
    </div>
</template>